# 求人情報自動収集システム - タウンワーク

<div align="center">

![Python](https://img.shields.io/badge/Python-3.9%2B-blue?logo=python&logoColor=white)
![PyQt6](https://img.shields.io/badge/PyQt6-GUI-41CD52?logo=qt&logoColor=white)
![Playwright](https://img.shields.io/badge/Playwright-1.40%2B-green?logo=playwright&logoColor=white)
![SQLite](https://img.shields.io/badge/SQLite-Database-003B57?logo=sqlite&logoColor=white)
![License](https://img.shields.io/badge/License-Educational-yellow)

**タウンワークから効率的に求人データを収集するためのデスクトップアプリケーション**

[クイックスタート](#クイックスタート) • [機能](#主な機能) • [使い方](#使い方)

</div>

---

## 目次

- [クイックスタート](#クイックスタート)
- [重要な注意事項](#重要な注意事項)
- [主な機能](#主な機能)
- [セットアップ](#セットアップ)
- [使い方](#使い方)
- [プロジェクト構造](#プロジェクト構造)
- [トラブルシューティング](#トラブルシューティング)
- [今後の開発](#今後の開発)
- [ライセンス](#ライセンス)

---

## クイックスタート

```bash
# 1. 依存パッケージのインストール
pip install -r requirements.txt

# 2. Playwrightブラウザのインストール
playwright install chromium

# 3. アプリケーション起動
python main.py
```

PyQt6ベースのデスクトップGUIが起動します。

---

## 重要な注意事項

> **警告**: このシステムは**技術検証・学習目的**で開発されています。

| ルール | 詳細 |
|--------|------|
| 利用規約 | 各サイトの利用規約を必ず確認してください |
| 商用利用 | 避けてください |
| アクセス頻度 | 適切に制限してください |
| robots.txt | 尊重してください |

---

## 主な機能

### 検索機能

| 機能 | 説明 |
|------|------|
| **地域選択** | 47都道府県から選択可能、地方単位での一括選択に対応 |
| **キーワード検索** | IT、事務、営業など40種類以上のプリセットキーワード |
| **カスタムキーワード** | 任意のキーワードを追加可能 |
| **並列処理** | 非同期処理による高速スクレイピング（1〜12並列） |

### フィルタ機能

| フィルタ | 説明 |
|----------|------|
| **電話番号重複削除** | 同一電話番号の求人を1件に集約 |
| **大企業除外** | 従業員数1,001人以上の企業を除外（しきい値変更可能） |
| **派遣・紹介除外** | 人材派遣、人材紹介等を含む企業を除外 |
| **業界フィルタ** | 広告、メディア、出版業界を除外 |
| **勤務地フィルタ** | 沖縄県の求人を除外 |
| **電話番号プレフィックス** | 0120、050、沖縄局番等を除外 |

### データ管理

| 機能 | 説明 |
|------|------|
| **SQLiteデータベース** | 取得した求人データを永続化 |
| **重複検出** | URL・求人IDによる重複排除 |
| **CSVエクスポート** | フィルタ前・後のデータをCSV出力 |
| **統計表示** | DB累計件数、新着件数、DBサイズを表示 |

### 技術的特徴

- **PyQt6 GUI** - ネイティブなデスクトップアプリケーション
- **Playwright** - 高速で安定したブラウザ自動化
- **Stealth設定** - ヘッドレスブラウザ検出回避
- **非同期処理** - UIをブロックせずにバックグラウンド実行
- **リアルタイム進捗** - 経過時間、取得件数、保存件数をリアルタイム表示

---

## セットアップ

### 必要要件

- Python 3.9以上
- Windows / macOS / Linux

### インストール

```bash
# 1. 依存パッケージのインストール
pip install -r requirements.txt

# 2. Playwrightブラウザのインストール
playwright install chromium

# 3. セットアップ検証（オプション）
python verify_setup.py
```

---

## 使い方

### アプリケーション起動

```bash
python main.py
```

### 画面構成

アプリケーションは左右2パネル構成です：

**左パネル（設定）**
- **地域選択タブ**: 都道府県を選択（地方単位での一括選択可能）
- **キーワードタブ**: 検索キーワードを選択（カスタムキーワード追加可能）
- **フィルタ・オプションタブ**: フィルタ設定と検索オプション

**右パネル（結果）**
- **検索結果タブ**: 取得した求人一覧
- **フィルタ結果タブ**: フィルタ適用後の求人一覧

### 基本的な操作手順

1. **地域を選択**: 左パネルの「地域選択」タブで都道府県を選択
2. **キーワードを選択**: 「キーワード」タブで検索キーワードを選択
3. **検索実行**: 「検索実行」ボタンをクリック
4. **フィルタ適用**: 検索結果タブで「フィルタ適用」ボタンをクリック
5. **CSVエクスポート**: 必要に応じてCSV出力

### 検索オプション

| オプション | 説明 | デフォルト |
|------------|------|------------|
| 最大ページ数 | 各検索条件で取得するページ数 | 5 |
| 並列数 | 同時に処理する数 | 5 |

---

## プロジェクト構造

```
scraping/
├── main.py                      # エントリーポイント（GUIを起動）
├── requirements.txt             # 依存パッケージ
│
├── src/                         # メインソースコード
│   ├── gui/
│   │   ├── main_window.py       # PyQt6メインウィンドウ
│   │   └── styles.py            # UIスタイル定義
│   │
│   ├── services/
│   │   ├── crawl_service.py     # クローリングサービス
│   │   └── csv_exporter.py      # CSVエクスポート
│   │
│   ├── database/
│   │   ├── db_manager.py        # データベース管理
│   │   └── job_repository.py    # 求人データリポジトリ
│   │
│   ├── filters/
│   │   └── job_filter.py        # フィルタ処理
│   │
│   └── models/
│       ├── job.py               # 求人モデル
│       └── search_condition.py  # 検索条件モデル
│
├── scrapers/
│   ├── townwork.py              # タウンワークスクレイパー
│   └── base_scraper.py          # ベーススクレイパー
│
├── utils/
│   ├── stealth.py               # ステルス設定
│   ├── page_utils.py            # ページユーティリティ
│   └── ...                      # その他ユーティリティ
│
└── data/
    ├── db/                      # SQLiteデータベース
    └── output/                  # CSVエクスポート先
```

---

## トラブルシューティング

### アプリが起動しない

```bash
# PyQt6がインストールされているか確認
pip show PyQt6

# 再インストール
pip install --upgrade PyQt6
```

### データが取得できない

1. **ネットワーク接続を確認**
2. **並列数を減らす**: フィルタ・オプションタブで並列数を1〜3に設定
3. **ヘッドレスモード無効化**: `scrapers/townwork.py`の`headless=False`に変更してブラウザ動作を確認

### Playwrightエラー

```bash
# ブラウザを再インストール
playwright install chromium --with-deps
```

### CSVが文字化けする

- CSVはUTF-8で出力されます
- Excelで開く場合は「データ」→「テキストから」でUTF-8を指定

---

## 今後の開発

- [ ] 複数求人サイト対応（バイトル、Indeed等）
- [ ] エラーリトライ機能の強化
- [ ] スケジューラー機能（定期実行）
- [ ] 詳細ログビューア

---

## ライセンス

このプロジェクトは**教育・研究目的**でのみ使用してください。

商用利用は禁止されています。

---

<div align="center">

**最終更新**: 2025-11-28

---

Made with PyQt6 + Playwright + SQLite

</div>
